<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
     xmlns:svg="http://www.w3.org/2000/svg"
     xml:lang="en">
<head> 
<META HTTP-EQUIV="Pragma" CONTENT="no-cache">
<meta http-equiv="content-type" content="text/html; charset=UTF8">

<title>Argo Documentation</title>

<!-- My little icon in the link url -->
<link rel="icon"  type="image/png" href="../images/icon" />  
<link rel="stylesheet" href="help.css" type="text/css" media="all"/>

<link href="../css/le-frog/jquery-ui.css" rel="stylesheet">
<link href="../css/le-frog/jquery.ui.theme.css" rel="stylesheet">
<script src="../js/jquery-1.9.0.js"></script>
<script src="../js/jquery-ui-1.10.0.custom.js"></script>

<script type="text/javascript" charset="utf-8">
$(function(){
  
  // style portlets and add icons.
  var headers = $(".portlet").addClass("ui-widget ui-widget-content ui-helper-clearfix ui-corner-all")
                .find(".portlet-header");
  headers.addClass("ui-widget-header ui-corner-all");
});
</script>

</head>

<body>
 <div id='everything'>
  <div id='help-sidebar' class="portlet">
    <div class="portlet-header">Table of Contents</div>
    <div class="portlet-content">
      <ul>
        <li><a href='#data'>       Getting your data        </a></li>
        <li><a href='#layout'>     Layout And Configuration </a></li>
        <li><a href='#zooming'>    Zooming and Panning      </a></li>
        <li><a href='#trid'>       The 3D display           </a></li>
        <li><a href='#optics'>     Optical hit display      </a></li>
        <li><a href='#keys'>       Keyboard Shortcuts       </a></li>
        <li><a href='#mc'>         Navigating Monte Carlo   </a></li>
        <li><a href='#printing'>   Printing                 </a></li>
        <li><a href='#howitworks'> How it works             </a></li>
        <li><a href='#browsers'>   Browser and Compatibility</a></li>
        <li><a href='#tips'>       Hints, Tricks, Tips      </a></li>
        <li><a href='#argo'>       Why "Argo"?      </a></li>
        
        
      </ul>
      <p><a href="..">Return to Argo</a></p>
      <p>Questions? Comments?<br/> Contact <a href="mailto:ntagg@otterbein.edu">Nathaniel</a></p>
    </div>    
  </div>

  <div id='help-main' class="portlet">
    
    <div class='portlet-header' id ='data'>       Getting your data        </div>
    <div class='portlet-content'>
      <img class="floatright" src="data-portlet.png" />
      <p> By default,the viewer loads a 10-event beam MC file.</p>
      <p> You can load any MicroBoone Larsoft-generated data file by typing the full path name into the 'Filename' box. 
        The viewer has access to any file on <span class='code'>/uboone/data</span> or <span class='code'>/uboone/app</span>.
      </p>
      <p> Even easier, click on the 'File Browser' link, and you can manually navigate to the directory of your choice, and
        just click the file name to load the first event in that file.
      </p>
      <p> Note that the system only works on LarSoft files containing 'Event' trees. </p>

      <p> To show your cool neato event with someone else, right-click on the "Link to This Event" link at the top of the page, 
        and select 'Copy Link Address'.  Then cut and paste into an email to share with others, or copy it to your
        logbook so you can study it later.</p>
 
      <p>If your event isn't working, click the 'Email This Event' link, and it will open an email you can send to me for your bug report.</p>


      <p> To search for a specific event, you can use the "Cut" field just like you would a cut in a ROOT TTree draw command. For example:<br/
        Cut: <span class='code'>fPE&gt;10</span><br/>
        Entry: <span class='code'>0</span><br/>
        will find the first event in the file that has one or more optical hits greater than 10 PE.</p>
      <p> Another example: <br/>
        Cut: <span class='code'>fMCNeutrino.fLepton.fGvtx.fE&gt;1.2</span><br/>
        Entry: <span class='code'>22</span><br/>
        will look for an event with lepton energy greater than 1.2 GeV, starting with the 22nd entry in the file.
      </p>
    </div> <!-- portlet-content -->
    



    <div class='portlet-header' id ='layout'>     Layout And Configuration </div>
    <div class='portlet-content'>
    
      <div class="floatright"><iframe width="320" height="180" src="http://www.youtube.com/embed/Y9MSlyq_sAw?autoplay=1&loop=1&playlist=Y9MSlyq_sAw" frameborder="0" allowfullscreen></iframe></div>
      <p> Don't like how the display is laid out? Change it! </p>
      <p> Clicking the '+' sign in the top-right corner of any pane will shrink that pane.</p>
      <p> Dragging the title bar of any pane will let you move it to a different part of the screen. </p>
      <p> To save your changes for the next time you use Argo, click the "Save" button in the Configuration pane. 
      To go back to the old way, click on 'Restore Defaults' </p>
      
    </div> <!-- portlet-content -->
      
    <div class='portlet-header' id ='zooming'>    Zooming and Panning      </div>
    <div class='portlet-content'>
      
      <div class="floatleft"><iframe width="320" height="180" src="http://www.youtube.com/embed/xZy68ZLe6PQ?autoplay=1&loop=1&playlist=xZy68ZLe6PQ" frameborder="0" allowfullscreen></iframe></div>
      
      <h3> Histograms </h3>
      <p> To pan the histogram content left and right, click and drag in the histogram body. </p>
      <p> To change the scale of the histogram, click on the horizontal axis and drag left and right. </p>
      
      <h3> Wire Views </h3>
      <p> Note that hovering your mouse over the view brings up a 'magnifying glass' (adjustable from the Configuration pane)
        which lets you see fine detail. In addition, the hovering your mouse will bring up a 1D wire profile in the 'Wire Info' pane.
        so you can see the waveform of that particular wire.</p>
      
      <p> Drag in the body of the image to pan in wire number or TDC.  Drag the axes to change the scale. </p>
      <p> The Time Histogram pane stays zoomed on the same region as the wire views.</p>
      <p> Note that the three wire views will all zoom together, so that the number of wires on the horizontal axes 
        stay the same, and the TDC count all stays the same. If you click the checkbox marked <strong>Lock TDC?/Wire Aspect Ratio</strong>
        then the TDC and Wire axes will stay locked so that views are proportional. This is useful for
        estimating angles, which will otherwise be distorted.
       </p>
        <img class='floatright' src='zoom-control.png' width='200px' />
      <p> The 'Zoom Control' pane shows a picture of which wires you are looking at, as looking at the back of the
        ZY wire plane. The red stripe indicates the wires you that are visible in plane 0 (view 0), the green is plane 1, and the blue is
        plane 2. If all three views are centered on the event, it is located inside the overlapping octagonal region.
      </p>
      <p> You can adjust the zoom by dragging this octagonal region, or by clicking and dragging any of the strip edges.
        Note that the viewer will do it's best to keep your view centered when you do this.
      </p>
      <p> By default, the viewer will try to 'auto zoom' when a new event is loaded.  (March 2013: this feature still
        is slightly buggy; it's hard to figure out all three views simultaneously.)
    </div> <!-- portlet-content -->
    
    
    
    <div class='portlet-header' id ='trid'>       The 3D display           </div>
    <div class='portlet-content'>
      <img class='floatright' width='200px' src='trid.png'/>
      Quick notes:
      <ul>
        <li>Click and drag to rotate the view.</li>
        <li>Right-click and drag to pan the view.</li>
        <li>Controls under the view allow zooming in and out, panning in X,Y and Z, setting the view to automatically spin
          around the Z axis, flip the rotate and pan controls, etc.</li>
        <li>Using the toggle switches on the bottom right (XZ, YZ, XY) you can choose an orthographic (non-perspective) display
          in each of those orientations. Clicking the 3D view returns to the perspective orientation.</li>
        <li> At present, only Tracks and Spacepoints are shown (since they are the only truly 3D objects), but more will be coming. </li>
      </ul>
    </div> <!-- portlet-content -->
    
    <div class='portlet-header' id ='Optics'>     Optical hit display      </div>
    <div class='portlet-content'>
      <img class='floatright' width='200px' src='pmts.png'/>
      <ul>
        <li>Time is represented as color. The earliest hit gives the PMT its color on the map (bottom).</li>
        <li>Hits out of bounds on the histogram (top) will be trimmed from the map (bottom), so you can dynamically cut. </li>
        <li>OpFlashes are shown as elliptical clouds. </li>
        <li>Hovering the mouse over a hit will highlight that PMT's pe hit pattern in the histogram.</li>
      </ul>
      
    </div> <!-- portlet-content -->

    <div class='portlet-header' id ='keys'>       Keyboard Shortcuts       </div>
    <div class='portlet-content'>
      <table id='keys'>
        <tr><th><strong>Key</strong></th><th>Effect</th></tr>
        <tr><td><strong>n</strong></td><td>  Next Event</td></tr>
        <tr><td><strong>p</strong></td><td>  Previous Event</td></tr>
        <tr><td><strong>w</strong></td><td>  Toggle Wire Digitizations</td></tr>
        <tr><td><strong>h</strong></td><td>  Toggle Wire Hits</td></tr>
        <tr><td><strong>c</strong></td><td>  Toggle Clusters</td></tr>
        <tr><td><strong>s</strong></td><td>  Toggle Spacepoints</td></tr>
        <tr><td><strong>t</strong></td><td>  Toggle Tracks</td></tr>
        <tr><td><strong>shift-P</strong></td><td>  Open new tab with current portlet view, suitable for printing.
          <br/>(Useful if you want to print a pane with the Magnifying Glass effect)</td></tr>
        <tr><td><strong>shift-L</strong></td><td>  Print entire page. (Again, shows mouse-over effects.)</td></tr>
      </table>
      <br/>
    </div> <!-- portlet-content -->
    
    <div class='portlet-header' id ='mc'>         Navigating Monte Carlo   </div>
    <div class='portlet-content'>
      <div class="floatright"><iframe width="320" height="180" src="http://www.youtube.com/embed/9nU2dZs2AnA?autoplay=1&loop=1&playlist=9nU2dZs2AnA" frameborder="0" allowfullscreen></iframe></div>
      <p>The basics of the Monte Carlo interaction are shown in the MC Info pane. If multiple interactions are present, they will be listed in an "accordion": click on the interaction number to see the details.</p>
      <p>The 'MC Digraph' window shows the cause-and-effect tree for the interaction. On the left is the neutrino interaction,
        and on the right are the immediate daughter particles (the 'final state' particles) that were propagated into Geant.
        Clicking on a particle opens up another layer of the tree, showing other tracked particles (G4Trajectories) that were created.
        Hovering the mouse over any particle will reveal that particle trajectory in red. 
      </p>
      <p>Note that to reduce visual clutter, neutrons and photons are not drawn in blue; they are only shown if you hover the mouse over that
        particle label in the DiGraph.</p>
    </div> <!-- portlet-content -->
    
    <div class='portlet-header' id ='printing'>   Printing   </div>
    <div class='portlet-content'>
      <p>There are several ways to print your event:
        <ul>
          <li>Take a screenshot of the window. The Mac OS X 'Preview' application does a good job of this.</li>
          <li>Click the "Print" button near the top of the page. This will open a new tab with a copy of the current page, and open up a print dialog.  You can simply 
            print to a PDF file to save it. Note that this method increases the resolution of all the displays by a factor of 5, so they can
            be reproduced at high resolution. If the extra resolution makes it too hard to see (lines too thin) then I suggest just doing a simple screenshot.</li>
          <li>Clicking the print icon in the pane header <img src='print-icon.png'> will generate a high-resolution image of that pane.</li>
          <li>The key shortcut shift-P will print the current pane (allowing you to capture the magnifying glass effect if desired)</li>
        </ul>
      </p>
    </div> <!-- portlet-content -->


    <div class='portlet-header' id ='howitworks'> How it works             </div>
    <div class='portlet-content'>
      <p> This webpage works in a fundamentally similar way as it's predecessors <a href="http://minerva05.fnal.gov/Arachne/arachne.html">Arachne</a> 
        and <a href="http://ariadne-minos.fnal.gov">Ariadne</a>, for MINERvA and MINOS respectively.  Arachne has been
        detailed extensively in a <a href="http://dx.doi.org/10.1016/j.nima.2012.01.059">NIM paper</a>.
      </p>
      <p>Very briefly, the web page is in fact a JavaScript application, similar to Google Docs.  Nearly all of the 
        heavy lifting in displaying the event is done inside your browser. This keeps the load on your fancy laptop,
        and not on the burdened old servers at Fermilab. The Argo web application in your browser requests data from the
        server using an AJAX XHttpRequest request call to a server-side Perl script.</p>
        <p>The Perl script finds the requested file, and then makes a UNIX socket request to a standalone, always-running
          process called <span class='code'>argo-backend</span>.  This is a ROOT-based program that opens the requested file,
          finds an appropriate entry in the <span class='code'>Events</span> tree, and then copies the data into 
          a JSON document for delivery back to the user's browser.
        </p>
        <p> Important differences from the earlier Arachne browser include the fact that the system uses JSON
          (JavaScript Object Notation) rather than XML. Tests show that JSON parses faster than XML by a factor of almost
          one hundred in Chrome, and makes coding far simpler. 
        </p>
        <p> Another important optimization is the raw/calibrated Wire data in Microboone.  A typical event has 3200
          TDC ticks collected over a total of 8000 wires. Even if data were truncated to one byte per sample, this 
          is over twenty megabytes of unpacked data. Sent in JSON format, the resulting document is nearly 100 MB, and
          is too large to be rendered in meaningful time.  So, Argo uses some mischievous tricks. It encodes the wire data
          in a pre-rendered PNG image, using a 256-color lookup palette to improve transmission time. In fact, it encodes
          the raw and calibrated data three times each.  One image is the one you see in the wire views.  One image is
          the grainy version that you see when panning or scrolling (used to save time when rendering the screen), and one
          image contains the full wire data used by the waveform Wire Info pane. 
        </p>
        <p> One by-product is that it is not possible to change the color scheme for the wire digitizations on the 
          fly, and the back-end is heavily taxed by the translation to PNG.  However, the back-end can encode everything
          in under 6 seconds, which is sufficiently fast for the system to be responsive.
        </p>
    </div> <!-- portlet-content -->
    
    <div class='portlet-header' id ='browsers'>   Browser and Compatibility</div>
    <div class='portlet-content'>
      <p> Tests have shown that the viewer performs best under Google Chrome. Firefox and Safari come in close behind.
        Other WebKit-based browsers should also work well.  Opera and Konqueror are known to work. The site should run
        acceptably well on iOS (iPhone, iPod) and Android devices.
      </p>
      <p> Microsoft IE 8 and above should work, providing the user is not using 'Quirks' or 'Compatibility' mode, but MSIE is
        not officially supported, due to longstanding interoperability problems. 
      </p>
      <p> Older versions of browsers can be MUCH slower - in particular, the browsers bundled with Scientific Linux 5 and 6 
          are very outdated and will be slow.
      </p>
      <p> The viewer will take advantage of "Retina" screens on Retina MacBooks and iOS devices, by doubling the effective
        resolution of all the views.</p>
    </div> <!-- portlet-content -->
    
   
   
    <div class='portlet-header' id ='hints'> Hints, Tips, and Tricks            </div>
    <div class='portlet-content'>
      <ul>
        <li>You can use the Control-minus / Control-plus keys to zoom the text and content of the window, just like on
          any other web page.</li>
      </ul>
    </div> <!-- portlet-content -->
   
    <div class='portlet-header' id ='argo'> Why "Argo"?            </div>
    <div class='portlet-content'>
      <p> The MINERvA viewer was called "Arachne", named after a weaver who won a famous contest with the goddess Minerva
        to see who could weave the fastest, and was turned into a spider for her hubris.</p>
        <p> Keeping in this classical vein, I tried to find a good name related to Argon, but by far the simplest
          linguistic jump was to the stories of the Argonauts.  The Argo was the name of the boat they 
          sailed.  What tipped me, of course, was the use of JSON (Jason) in the viewer; the pun was too good to pass up.
        </p>
    </div> <!-- portlet-content -->
   
   
   
    </div>   <!-- help-main -->
     
  </div>

 </div> <!-- everything --> 
</body>

</html>
